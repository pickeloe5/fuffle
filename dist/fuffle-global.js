var Fuffle;(()=>{"use strict";var __webpack_modules__={65:(t,e,n)=>{n.d(e,{Z:()=>r});var s=n(891);const r=class{#t=[];observer=null;constructor(t=null){this.observer=t}start(t=this.observer){return this.observer=t,this.runTracked(),t.addEventListener("write",this.#e),this}onStop(){}stop(){return this.observer?.removeEventListener("write",this.#e),this.onStop(),this}run(){}withRun(t){return this.run=t,this}onRun(t){}withOnRun(t){return this.onRun=t,this}runTracked(){const t=this.observer.trackReads(),e=this.run.call(this.observer.proxy);this.#t=t(),this.onRun(e)}#e=({propertyPath:t})=>{this.#t.some((0,s.pathEquals)(t))&&this.runTracked()}}},51:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _Base_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(65);class Binding extends _Base_js__WEBPACK_IMPORTED_MODULE_0__.Z{state={js:"",locals:null};constructor(t){super(),t&&(this.state.js=t),this.run=this.#n()}withLocals(t={}){return this.state.locals=t,this}withJs(t){return this.state.js=t,this.observer&&this.runTracked(),this}#n(){const{state}=this;return function(){let js="";if(state.locals)for(const t in state.locals)js+=`const ${t}=state.locals.${t}?.(this, '${t}');`;return eval(js+state.js)}}}const __WEBPACK_DEFAULT_EXPORT__=Binding},891:(t,e,n)=>{n.r(e),n.d(e,{EventName:()=>r,pathEquals:()=>s});const s=t=>e=>{if(e.length!==t.length)return!1;for(let n in t)if(e[n]!==t[n])return!1;return!0},r={ATTRIBUTE_CHANGED:"fuffle-attribute-changed"}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Binding:()=>r.Z,BindingBase:()=>i.Z,Component:()=>f,ComponentBase:()=>m,ComponentElement:()=>o,FuffleFor:()=>w,FuffleIf:()=>v,Observer:()=>s,Template:()=>b,TemplateInstance:()=>_,util:()=>t});var t=__webpack_require__(891);class e{static instance=new e}class n extends EventTarget{static resolve(t){return t&&t instanceof e?t.observer:null}static fromArray(t){const e=n.resolve(t);return Array.isArray(e?.target)?e:null}target=null;proxy=null;#s=null;parent=null;#r=null;constructor(t,e=!1){if(super(),this.target=t,!e){this.#r={};for(const e in t)this.#i(e)}this.proxy=this.#a()}withParent(t,e){return this.parent=t,this.#s=e,this}#o=null;trackReads(){if(this.#o)throw new Error("Concurrent modification exception");return this.#o=[],this.#h}#h=()=>{const t=[...this.#o];return this.#o=null,t};onRead(e){this.#o&&!this.#o.includes((0,t.pathEquals)(e))&&this.#o.push(e),this.parent?.onRead([this.#s,...e])}onWrite(t,e){const n=new Event("write");n.propertyPath=t,n.propertyValue=e,this.dispatchEvent(n),this.parent?.onWrite([this.#s,...t],e)}#i(t,e=this.target[t]){this.#r&&(e&&"object"==typeof e&&e!==this?this.#r[t]=new n(e).withParent(this,t):this.#r.hasOwnProperty(t)&&(this.#r[t].parent=null,delete this.#r[t]))}#a(){return new Proxy(this.target,{getPrototypeOf:t=>e.instance,get:(t,e,n)=>{if("observer"===e)return this;let s;return s=this.#r?.hasOwnProperty(e)?this.#r[e].proxy:Reflect.get(t,e,n),"function"==typeof s&&(s=s.bind(n)),this.onRead([e]),s},set:(t,e,n,s)=>{const r=Reflect.set(t,e,n,s);return this.#i(e,n),this.onWrite([e],n),r}})}}const s=n;var r=__webpack_require__(51),i=__webpack_require__(65);class a extends HTMLElement{static getInstance(t){return t.#l}static getObserver(t){const e=this.getInstance(t);if(!e)return null;const n=e.constructor?.getObserver(e);return n||null}static getParent(t){for(;t=t.parentNode;)if(t instanceof this)return this.getObserver(t);return null}static ComponentImpl=null;static get observedAttributes(){return this.ComponentImpl.Attribute?Object.values(this.ComponentImpl.Attribute):[]}#l;constructor(){super(),this.#l=new this.constructor.ComponentImpl(this),this.addEventListener(t.EventName.ATTRIBUTE_CHANGED,this.#c)}#c=({attributeName:t,attributeValue:e})=>{this.#l.onAttributeChanged(t,e)};connectedCallback(){this.isConnected&&setTimeout((()=>{this.#l.onConnected(a.getParent(this))}),0)}disconnectedCallback(){this.#l.onDisconnected()}attributeChangedCallback(t,e,n){this.#l.onAttributeChanged(t,n)}}const o=a;class h extends r.Z{#u=null;#s="";#d=!1;constructor(t,e,n,s=!1){super(n),this.#u=t,this.#s=e,this.#d=!!s}onRun(e){this.#d&&this.#u.setAttribute(this.#s,e);const n=new Event(t.EventName.ATTRIBUTE_CHANGED);n.attributeName=this.#s,n.attributeValue=e,this.#u.dispatchEvent(n)}}class l extends r.Z{#u=null;#s="";#_=null;constructor(t,e,n){super(n),this.#u=t,this.#s=e}onStop(){this.#_&&this.#u.removeEventListener(this.#s,this.#_)}onRun(t){this.onStop(),this.#u.addEventListener(this.#s,t),this.#_=t}}class c extends r.Z{#u=null;constructor(t,e=""){super(`\`${e}\``),this.#u=t}onRun(t){this.#u.nodeValue=t}}class u extends r.Z{#u=null;constructor(t,e){super(e),this.#u=t}onRun(t){this.#u.value=t}}class d{static getTextMode(t,e=!1){let n=!1;return t.hasAttribute(d.Attribute.TEXT)&&(n=t.getAttribute(d.Attribute.TEXT)===d.Text.SHALLOW?d.Text.SHALLOW:d.Text.DEEP),n||e===d.Text.SHALLOW||(n=e),n}static Text={SHALLOW:"shallow",DEEP:"deep"};static Attribute={TEXT:"data-f-text",VALUE:"data-f-value"};static Prefix={ATTRIBUTE:"data-f:",ATTRIBUTE_STRING:"data-f-s:",EVENT:"data-f-on:"};#p;#b=null;#m=[];#f=null;children=[];constructor(t,e){this.children=t,this.#p=e}withParent(t){this.#f=t;for(const e of this.children)t.appendChild(e);return this}withLocals(t){return this.#b=t,this}start(t){this.#v(this.children,this.#p);for(const e of this.#m)e.start(t);return this}stop(){for(const t of this.#m)t.stop();return this}withoutParent(){if(this.#f)for(const t of this.children)this.#f.removeChild(t);return this.#f=null,this}#v(t,e){for(const n of t)switch(n.nodeType){case Node.TEXT_NODE:this.#w(n,e);break;case Node.ELEMENT_NODE:this.#g(n,e)}}#w(t,e){if(!e)return;const n=t.nodeValue;t.nodeValue="",this.#m.push(new c(t,n).withLocals(this.#b))}#g(t,e){for(const e of t.getAttributeNames())this.#E(t,e);t instanceof o||this.#v(t.childNodes,d.getTextMode(t,e))}#E(t,e){if(e===d.Attribute.VALUE)return void this.#m.push(new u(t,t.getAttribute(e)));const[n,s]=this.#T(e);if(!n)return;const r=t.getAttribute(e);switch(n===d.Prefix.ATTRIBUTE_STRING&&t.removeAttribute(e),n){case d.Prefix.ATTRIBUTE:this.#m.push(new h(t,s,r).withLocals(this.#b));break;case d.Prefix.ATTRIBUTE_STRING:this.#m.push(new h(t,s,r,!0).withLocals(this.#b));break;case d.Prefix.EVENT:this.#m.push(new l(t,s,r).withLocals(this.#b))}}#T(t){for(const e of Object.values(d.Prefix))if(t.startsWith(e))return[e,t.substring(e.length)];return["",t]}}const _=d;class p{static fromNode(t){return new p([...t.content.childNodes],_.getTextMode(t))}#r=[];#p=!1;constructor(t,e=!1){this.#r=t,this.#p=e}bake(){return new _(this.#r.map((t=>t.cloneNode(!0))),this.#p)}}const b=p,m=class{static fromElement(t){return t instanceof o?o.getInstance(t):null}static getObserver(t){return null}static defineElement(t){const e=this,n=class extends o{static ComponentImpl=e};return customElements.define(t,n),n}constructor(t){}onConnected(t){}onAttributeChanged(t,e){}onDisconnected(){}},f=class extends m{static getObserver(t){return t.#A}static template=null;#x=null;#A=null;#k=this.constructor.template?.bake();constructor(t){super(t),this.#x=t}onConnected(){if(this.#A=new s(this),!this.#k){const t=[...this.#x.childNodes];for(const e of t)this.#x.removeChild(e);this.#k=new b(t)}this.#k.withParent(this.#x).start(this.#A)}onDisconnected(){this.#k.stop().withoutParent()}};class v extends m{static Attribute={CONDITION:"data-condition"};#C=null;#x=null;#O=null;#k=null;#_=!1;constructor(t){super(t),this.#x=t,this.#k=new _([...t.childNodes].map((t=>t.cloneNode(!0)))),this.#O=t.attachShadow({mode:"open"})}onDisconnected(){this.#k.stop()}onConnected(t){this.#C=t,this.#_&&this.#y()}#y(){this.#C&&this.#k.withParent(this.#O).start(this.#C)}#P(){this.#k.stop().withoutParent()}onAttributeChanged(t,e){t===v.Attribute.CONDITION&&(e=!!e)!==this.#_&&(this.#_=e,e?this.#y():this.#P())}}v.defineElement("fuffle-if");class w extends m{static Attribute={ARRAY:"data-array",NAME:"data-name"};#C=null;#N=null;#x=null;#O=null;#k=null;#r=[];#R="it";constructor(t){super(t),this.#x=t,this.#O=t.attachShadow({mode:"open"}),this.#k=new b([...t.childNodes])}onDisconnected(){for(this.#N?.removeEventListener("write",this.#e);this.#r.length;)this.#L()}onConnected(t){this.#C=t,this.#I()}onAttributeChanged(t,e){switch(t){case w.Attribute.NAME:this.#D(e);break;case w.Attribute.ARRAY:this.#S(e)}}#D(t){this.#R=t;for(const t in this.#r)this.#r[t].withLocals(this.#B(t))}#S(t){for(this.#N?.removeEventListener("write",this.#e);this.#r.length;)this.#L();this.#N=s.fromArray(t),this.#I()}#I(){if(this.#N&&this.#C){for(const t in this.#N.target)this.#M(t);this.#N.addEventListener("write",this.#e)}}#e=({propertyPath:t,propertyValue:e})=>{if(1===t.length&&"length"===t[0]&&e!==this.#r.length){for(let t=this.#r.length;t<e;t++)this.#M(t);for(let t=this.#r.length-1;t>=e;t--)this.#L()}};#M(t,e=this.#N.target[t]){this.#r.push(this.#k.bake().withLocals(this.#B(t)).withParent(this.#O).start(this.#C))}#L(){this.#r.pop().stop().withoutParent()}#B(t){return{[this.#R]:()=>this.#N.proxy[t]}}}w.defineElement("fuffle-for")})(),Fuffle=__webpack_exports__})();