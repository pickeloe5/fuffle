var Fuffle;(()=>{"use strict";var __webpack_modules__={65:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(891);const r=class{#e=[];observer=null;constructor(e=null){this.observer=e}start(e=this.observer){return this.observer=e,this.runTracked(),e.addEventListener("write",this.#t),this}onStop(){}stop(){return this.observer?.removeEventListener("write",this.#t),this.onStop(),this}run(){}withRun(e){return this.run=e,this}onRun(e){}withOnRun(e){return this.onRun=e,this}runTracked(){const e=this.observer.trackReads(),t=this.run.call(this.observer.proxy);this.#e=e(),this.onRun(t)}#t=({propertyPath:e})=>{this.#e.some((0,s.pathEquals)(e))&&this.runTracked()}}},51:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _Base_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(65);class Binding extends _Base_js__WEBPACK_IMPORTED_MODULE_0__.Z{state={js:"",locals:null};constructor(e){super(),e&&(this.state.js=e),this.run=this.#n()}withLocals(e={}){return this.state.locals=e,this}withJs(e){return this.state.js=e,this.observer&&this.runTracked(),this}#n(){const{state}=this;return function(){let js="";if(state.locals)for(const e in state.locals)js+=`const ${e}=state.locals.${e}?.(this, '${e}');`;return eval(js+state.js)}}}const __WEBPACK_DEFAULT_EXPORT__=Binding},891:(e,t,n)=>{n.r(t),n.d(t,{EventName:()=>r,pathEquals:()=>s});const s=e=>t=>{if(t.length!==e.length)return!1;for(let n in e)if(t[n]!==e[n])return!1;return!0},r={ATTRIBUTE_CHANGED:"fuffle-attribute-changed"}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Binding:()=>r.Z,BindingBase:()=>i.Z,Component:()=>f,ComponentBase:()=>m,ComponentElement:()=>o,FuffleFor:()=>w,FuffleIf:()=>v,Observer:()=>s,Template:()=>b,TemplateInstance:()=>_,util:()=>e});var e=__webpack_require__(891);class t{static instance=new t}class n extends EventTarget{static resolve(e){return e&&e instanceof t?e.observer:null}static fromArray(e){const t=n.resolve(e);return Array.isArray(t?.target)?t:null}target=null;proxy=null;#s=null;parent=null;#r=null;constructor(e,t=!1){if(super(),this.target=e,!t){this.#r={};for(const t in e)this.#i(t)}this.proxy=this.#a()}withParent(e,t){return this.parent=e,this.#s=t,this}#o=null;trackReads(){if(this.#o)throw new Error("Concurrent modification exception");return this.#o=[],this.#h}#h=()=>{const e=[...this.#o];return this.#o=null,e};onRead(t){this.#o&&!this.#o.includes((0,e.pathEquals)(t))&&this.#o.push(t),this.parent?.onRead([this.#s,...t])}onWrite(e,t){const n=new Event("write");n.propertyPath=e,n.propertyValue=t,this.dispatchEvent(n),this.parent?.onWrite([this.#s,...e],t)}#i(e,t=this.target[e]){this.#r&&(t&&"object"==typeof t&&t!==this?this.#r[e]=new n(t).withParent(this,e):this.#r.hasOwnProperty(e)&&(this.#r[e].parent=null,delete this.#r[e]))}#a(){return new Proxy(this.target,{getPrototypeOf:e=>t.instance,get:(e,t,n)=>{if("observer"===t)return this;let s;return s=this.#r?.hasOwnProperty(t)?this.#r[t].proxy:Reflect.get(e,t,n),"function"==typeof s&&(s=s.bind(n)),this.onRead([t]),s},set:(e,t,n,s)=>{const r=Reflect.set(e,t,n,s);return this.#i(t,n),this.onWrite([t],n),r}})}}const s=n;var r=__webpack_require__(51),i=__webpack_require__(65);class a extends HTMLElement{static getInstance(e){return e.#l}static getObserver(e){const t=this.getInstance(e);if(!t)return null;const n=t.constructor?.getObserver(t);return n||null}static getParent(e){for(;e=e.parentNode;)if(e instanceof this)return this.getObserver(e);return null}static ComponentImpl=null;static get observedAttributes(){return this.ComponentImpl.Attribute?Object.values(this.ComponentImpl.Attribute):[]}#l;constructor(){super(),this.#l=new this.constructor.ComponentImpl(this),this.addEventListener(e.EventName.ATTRIBUTE_CHANGED,this.#c)}#c=({attributeName:e,attributeValue:t})=>{this.#l.onAttributeChanged(e,t)};connectedCallback(){this.isConnected&&setTimeout((()=>{this.#l.onConnected(a.getParent(this))}),0)}disconnectedCallback(){this.#l.onDisconnected()}attributeChangedCallback(e,t,n){this.#l.onAttributeChanged(e,n)}}const o=a;class h extends r.Z{#u=null;#s="";#d=!1;constructor(e,t,n,s=!1){super(n),this.#u=e,this.#s=t,this.#d=!!s}onRun(t){this.#d&&this.#u.setAttribute(this.#s,t);const n=new Event(e.EventName.ATTRIBUTE_CHANGED);n.attributeName=this.#s,n.attributeValue=t,this.#u.dispatchEvent(n)}}class l extends r.Z{#u=null;#s="";#_=null;constructor(e,t,n){super(n),this.#u=e,this.#s=t}onStop(){this.#_&&this.#u.removeEventListener(this.#s,this.#_)}onRun(e){this.onStop(),this.#u.addEventListener(this.#s,e),this.#_=e}}class c extends r.Z{#u=null;constructor(e,t=""){super(`\`${t}\``),this.#u=e}onRun(e){this.#u.nodeValue=e}}class u extends r.Z{#u=null;constructor(e,t){super(t),this.#u=e}onRun(e){this.#u.value=e}}class d{static getTextMode(e,t=!1){let n=!1;return e.hasAttribute(d.Attribute.TEXT)&&(n=e.getAttribute(d.Attribute.TEXT)===d.Text.SHALLOW?d.Text.SHALLOW:d.Text.DEEP),n||t===d.Text.SHALLOW||(n=t),n}static Text={SHALLOW:"shallow",DEEP:"deep"};static Attribute={TEXT:"data-f-text",VALUE:"data-f-value"};static Prefix={ATTRIBUTE:"data-f:",ATTRIBUTE_STRING:"data-f-s:",EVENT:"data-f-on:"};#p;#b=null;#m=[];#f=null;children=[];constructor(e,t){this.children=e,this.#p=t}withParent(e){this.#f=e;for(const t of this.children)e.appendChild(t);return this}withLocals(e){return this.#b=e,this}start(e){this.#v(this.children,this.#p);for(const t of this.#m)t.start(e);return this}stop(){for(const e of this.#m)e.stop();return this}withoutParent(){if(this.#f)for(const e of this.children)this.#f.removeChild(e);return this.#f=null,this}#v(e,t){for(const n of e)switch(n.nodeType){case Node.TEXT_NODE:this.#w(n,t);break;case Node.ELEMENT_NODE:this.#g(n,t)}}#w(e,t){if(!t)return;const n=e.nodeValue;e.nodeValue="",this.#m.push(new c(e,n).withLocals(this.#b))}#g(e,t){for(const t of e.getAttributeNames())this.#E(e,t);e instanceof o||this.#v(e.childNodes,d.getTextMode(e,t))}#E(e,t){if(t===d.Attribute.VALUE)return void this.#m.push(new u(e,e.getAttribute(t)));const[n,s]=this.#T(t);if(!n)return;const r=e.getAttribute(t);switch(n===d.Prefix.ATTRIBUTE_STRING&&e.removeAttribute(t),n){case d.Prefix.ATTRIBUTE:this.#m.push(new h(e,s,r).withLocals(this.#b));break;case d.Prefix.ATTRIBUTE_STRING:this.#m.push(new h(e,s,r,!0).withLocals(this.#b));break;case d.Prefix.EVENT:this.#m.push(new l(e,s,r).withLocals(this.#b))}}#T(e){for(const t of Object.values(d.Prefix))if(e.startsWith(t))return[t,e.substring(t.length)];return["",e]}}const _=d;class p{static fromNode(e){return new p([...e.content.childNodes],_.getTextMode(e))}#r=[];#p=!1;constructor(e,t=!1){this.#r=e,this.#p=t}bake(){return new _(this.#r.map((e=>e.cloneNode(!0))),this.#p)}}const b=p,m=class{static fromElement(e){return e instanceof o?o.getInstance(e):null}static getObserver(e){return null}static defineElement(e){const t=this,n=class extends o{static ComponentImpl=t};return customElements.define(e,n),n}constructor(e){}onConnected(e){}onAttributeChanged(e,t){}onDisconnected(){}},f=class extends m{static getObserver(e){return e.#A}static template=null;#x=null;#A=null;#k=this.constructor.template?.bake();#r=null;constructor(e){super(e),this.#x=e}onConnected(){if(this.#A=new s(this),!this.#k){this.#r=[...this.#x.childNodes];for(const e of this.#r)this.#x.removeChild(e);this.#k=new b(this.#r).bake()}this.#k.withParent(this.#x).start(this.#A)}onDisconnected(){if(this.#k?.stop().withoutParent(),this.#r){for(const e of this.#r)this.#x.appendChild(e);this.#r=null}}};class v extends m{static Attribute={CONDITION:"data-condition"};#x=null;#k=null;#r=null;#C=null;#_=!1;constructor(e){super(e),this.#x=e}onDisconnected(){this.#k?.stop().withoutParent(),this.#k=null}onConnected(e){this.#C=e,this.#r=[...this.#x.childNodes];for(const e of this.#r)this.#x.removeChild(e);this.#k=new _(this.#r),this.#_&&this.#O()}#O(){this.#C&&this.#k.withParent(this.#x).start(this.#C)}#y(){this.#k.stop().withoutParent()}onAttributeChanged(e,t){e===v.Attribute.CONDITION&&(t=!!t)!==this.#_&&(this.#_=t,t?this.#O():this.#y())}}v.defineElement("fuffle-if");class w extends m{static Attribute={ARRAY:"data-array",NAME:"data-name",INDEX_NAME:"data-index-name"};#C=null;#P=null;#x=null;#r=null;#k=null;#N=[];#R="it";#L="index";constructor(e){super(e),this.#x=e}onDisconnected(){if(this.#P?.removeEventListener("write",this.#t),this.#I(),this.#C=null,this.#r)for(const e of this.#r)this.#x.appendChild(e)}onConnected(e){this.#C=e,this.#r=[...this.#x.childNodes],this.#k=new b(this.#r);for(const e of this.#r)this.#x.removeChild(e);this.#D()}onAttributeChanged(e,t){switch(e){case w.Attribute.NAME:this.#R=t,this.#M();break;case w.Attribute.INDEX_NAME:this.#L=t,this.#M();break;case w.Attribute.ARRAY:this.#B(t)}}#M(){for(let e=0;e<this.#N.length;e++)this.#N[e].withLocals(this.#S(e))}#B(e){this.#P?.removeEventListener("write",this.#t),this.#I(),this.#P=s.fromArray(e),this.#D()}#D(){if(this.#P&&this.#C){for(let e=0;e<this.#P.target.length;e++)this.#W(e);this.#P.addEventListener("write",this.#t)}}#I(){for(;this.#N.length;)this.#q()}#t=({propertyPath:e,propertyValue:t})=>{if(1===e.length&&"length"===e[0]&&t!==this.#r.length){for(let e=this.#r.length;e<t;e++)this.#W(e);for(let e=this.#r.length-1;e>=t;e--)this.#q()}};#W(e,t=this.#P.target[e]){this.#N.push(this.#k.bake().withLocals(this.#S(e)).withParent(this.#x).start(this.#C))}#q(){this.#N.pop().stop().withoutParent()}#S(e){return{[this.#R]:()=>this.#P.proxy[e],[this.#L]:()=>e}}}w.defineElement("fuffle-for")})(),Fuffle=__webpack_exports__})();